var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var k=b++;return{value:c(k,a[k]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var k=a[d];k in b||(b[k]={});b=b[k]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6-impl","es3");
var debugMode=0,manifestData=chrome.runtime.getManifest(),globalConfig={childList:!0},altConfig={attributes:!0,childList:!0,subtree:!0},body=document.querySelector("body"),app=document.querySelector("#app"),defaultFilter={artists:[],tracks:[]},setGlobalSettings={},getGlobalSettings="darkMode fullwidthMode moreActionMenu removeSettingsBtn disableDiscoverToggle hideSidebar hideBranding displayType removePreviews removePlaylists removeLongTracks removeUserActivity removeReposts tagsArray filter hiddenOutline profileImages disableUnfollower discoverModules".split(" "),
skipPrevious=!1,oldLocation=location.href;debugMode&&console.log("-=- SCE DEBUGMODE ACTIVE -=-");
var insertAfter=function(a,c){c.parentNode.insertBefore(a,c.nextSibling)},relativeTime=function(a){a=Math.floor(Date.now()/1E3)-a;return 60>a?a+" sec ago":3600>a?Math.round(a/60)+" mins ago":86400>a?Math.round(a/3600)+" hrs ago":2592E3>a?Math.round(a/86400)+" days ago":31536E3>a?Math.round(a/2592E3)+" months ago":Math.round(a/31536E3)+" yrs ago"},runObserver=function(a,c,b,d){d=void 0===d?null:d;var k=b||!1;b=k?altConfig:globalConfig;(new MutationObserver(function(a){if(k)d?c(d):c();else{for(var b=
a.length,e=!1,m,p=0;p<b;p++)if(m=a[p],"childList"===m.type&&m.addedNodes.length){e=!0;break}e&&(d?c(d):c())}})).observe(a,b)},getCookie=function(a){a+="=";for(var c=document.cookie.split(";"),b=0;b<c.length;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return""},userID=getCookie("i"),userName=getCookie("p"),fetchFile=function(a,c,b){var d=new XMLHttpRequest;d.open("GET",chrome.extension.getURL(c),!0);d.onload=function(){if(200===d.status&&
(debugMode&&console.log("function fetchFile: File fetched"),a.innerHTML=d.responseText,b))return b()};d.send()},disassembleSettings=function(){var a=document.querySelector("#sce-settings");a.classList.add("invisible");a.style.overflow="hidden";app.classList.remove("g-filter-grayscale");setTimeout(function(){a.classList.remove("showBackground");setTimeout(function(){a.remove();body.classList.remove("g-overflow-hidden")},100)},300)},multiFollow=function(){for(var a=document.querySelectorAll(".userBadgeListItem"),
c=a.length,b=0;b<c;b++)if(null==a[b].querySelector(".userBadgeListItem__checkbox")){var d=document.createElement("label"),k=document.createElement("input"),e=document.createElement("div");d.className="userBadgeListItem__checkbox";k.type="checkbox";k.className="sc-checkbox-input sc-visuallyhidden";e.className="sc-checkbox-check";d.appendChild(k);d.appendChild(e);a[b].appendChild(d)}},stripLinkDomain=function(a){return a.replace("https://soundcloud.com/","")},massSelector=function(a){var c=function(){for(var b=
document.querySelectorAll(".badgeList__item"),c=b.length,e=0;e<c;e++)b[e].querySelector("label.userBadgeListItem__checkbox input.sc-checkbox-input").checked=a};if(1==a)var b=setInterval(function(){document.querySelector(".collectionSection .badgeList.lazyLoadingList .loading")?(window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight),debugMode&&console.log("Page scroll")):(clearInterval(b),window.scrollTo(0,0),c())},50);else c()},isPlaylistURL=function(a){a=a.split("/");
for(var c=a.length,b=!1,d=0;d<c;d++)"sets"==a[d]&&(b=!0);return b},moreActionParentClassName=function(a){return"."+a.closest(".lazyLoadingList").querySelector("div > ul > li, ul > li").className.split(/\s+/)[0]},moreActionMenuContent=function(a){getLocalStorage(function(c){var b=document.querySelector(".moreActions div"),d=a.querySelector(".playlistTrackCount")||a.querySelector(".compactTrackList__moreLink"),k=a.querySelector(".soundTitle__tagContent"),e=a.querySelector(".soundTitle__username, .chartTrack__username a, .playableTile__usernameHeading, .trackItem__username"),
g=a.querySelector(".soundTitle__title, .chartTrack__title a, .playableTile__artworkLink, .trackItem__trackTitle"),v=document.querySelector("#sce-moreActions-group"),m=document.createElement("div");m.className="moreActions__group";m.id="sce-moreActions-group";var p=function(){window.location.href=g.href+"/recommended"},w=function(a,b){b=void 0===b?null:b;if(!document.querySelector("#sce-"+a+"-button")){var f=document.createElement("button");f.type="button";f.id="sce-"+a+"-button";f.className="moreActions__button sc-button-medium sce-button-icon sce-button-"+
a+"";"related"==a?(f.title="Go to related tracks",f.innerText="Related tracks"):"track"==a?isPlaylistURL(b.href)?(f.title="Click to blacklist this playlist",f.innerText="Blacklist playlist"):(f.title="Click to blacklist this track",f.innerText="Blacklist track"):(f.title="Click to blacklist this track's "+a+"",f.innerText="Blacklist "+a+"");"related"!=a&&f.setAttribute("data-item","artist"==a||"track"==a?b.href:b.innerText);"artist"==a?stripLinkDomain(e.href)!=userName&&m.appendChild(f):m.appendChild(f)}},
t=!1,l=!1,r=!1,h=!1;c.moreActionMenu&&("on"==c.moreActionMenu.relatedActionMenu&&(t=!0),"on"==c.moreActionMenu.tagActionMenu&&(l=!0),"on"==c.moreActionMenu.artistActionMenu&&(r=!0),"on"==c.moreActionMenu.trackActionMenu&&(h=!0));t||d||w("related");!l&&k&&w("hashtag",k);!r&&e&&w("artist",e);!h&&g&&w("track",g);v||m.hasChildNodes()&&b.appendChild(m);c=document.querySelector("#sce-related-button");b=document.querySelector("#sce-hashtag-button");d=document.querySelector("#sce-artist-button");k=document.querySelector("#sce-track-button");
!t&&c&&(c.removeEventListener("click",p),c.addEventListener("click",p));!l&&b&&addTagToFilter(b);!r&&d&&addItemToFilter(d,"artists");!h&&k&&addItemToFilter(k,"tracks")})},addItemToFilter=function(a,c){var b=function(){getLocalStorage(function(b){var d,e=a.getAttribute("data-item"),g=stripLinkDomain(e);b=b.filter||defaultFilter;var v=Math.floor(Date.now()/1E3),g={slug:g,time:v};"artists"==c?(b.artists.push(g),d=document.querySelectorAll(".soundTitle__username, .chartTrack__username a, .playableTile__usernameHeading, .trackItem__username")):
"tracks"==c&&(b.tracks.push(g),d=document.querySelectorAll(".soundTitle__title, .chartTrack__title a, .playableTile__artworkLink, .trackItem__trackTitle"));setLocalStorage(function(){if(chrome.runtime.lastError)alert("Error settings:\n\n"+chrome.runtime.lastError);else{document.querySelector(".sc-button-more.sc-button.sc-button-active").click();for(var a=d.length,b=0;b<a;b++)if(d[b].href==e){var c=moreActionParentClassName(d[b]);d[b].closest(c).remove()}}},{filter:b})})};a.removeEventListener("click",
b);a.addEventListener("click",b)},addTagToFilter=function(a){var c=function(){getLocalStorage(function(b){var c=a.getAttribute("data-item");b=b.tagsArray||[];b.push(c);setLocalStorage(function(){var a=document.querySelectorAll(".soundTitle__tagContent");if(chrome.runtime.lastError)alert("Error settings:\n\n"+chrome.runtime.lastError);else{document.querySelector(".sc-button-more.sc-button.sc-button-active").click();for(var b=0;b<a.length;b++)if(a[b].innerText.toUpperCase()==c.toUpperCase()){var d=
moreActionParentClassName(a[b]);a[b].closest(d).remove()}}},{tagsArray:b})},["tagsArray"])};a.removeEventListener("click",c);a.addEventListener("click",c)},eliminateDuplicates=function(a){var c,b=a.length,d=[],k={};for(c=0;c<b;c++)k[a[c]]=0;for(c in k)d.push(c);return d},exportimportInit=function(a){a=document.querySelector('#sce-import input[type="file"]');document.querySelector("#sce-export a").addEventListener("click",function(){getLocalStorage(function(a){var b=new Blob([JSON.stringify(a,null,
"\t")],{type:"application/json"});a=document.createElement("a");b=window.URL.createObjectURL(b);document.body.appendChild(a);a.style="display: none";a.href=b;a.download="SCEnhancer.json";a.click();window.URL.revokeObjectURL(b)})});var c=function(a){a=JSON.parse(a.target.result);for(var b=Object.keys(a),c={},e=0;e<b.length;e++)switch(b[e]){case "discoverModules":Object.keys(a.discoverModules);var g={},v;for(v in a.discoverModules)isNaN(v)||(g[v]="1"==a.discoverModules[v]?"1":"0");c.discoverModules=
g;break;case "displayType":c.displayType="list"==a.displayType||"grid"==a.displayType?a.displayType:"default";break;case "filter":for(var g=[a.filter.artists,a.filter.tracks],m=g.length,p={},w=0;w<m;w++){var t=[],l;for(l in g[w]){var r=g[w][l],h=r.slug,u=r.time;if(h){u||(r.time=Math.floor(Date.now()/1E3));for(var u=t.length,q=0,f=0;f<u;f++)t[f].slug==h&&(q=1);0==q&&t.push(r)}}0==w?p.artists=t:p.tracks=t}c.filter=p;break;case "tagsArray":g=a.tagsArray.length;m=[];for(p=0;p<g;p++)m.push(a.tagsArray[p].toLowerCase());
c.tagsArray=eliminateDuplicates(m);break;case "moreActionMenu":var g={},x;for(x in a.moreActionMenu)g[x]="on"==a.moreActionMenu[x]?a.moreActionMenu[x]:"off";c.moreActionMenu=g;break;default:g=a[b[e]],"on"!=g&&(g="off"),c[b[e]]=g}setLocalStorage(function(){chrome.runtime.lastError?alert("Error settings:\n\n"+chrome.runtime.lastError):location.reload()},c)};a.addEventListener("change",function(a){a=a.target.files;var b=new FileReader;b.onload=c;b.readAsText(a[0])},!1)},settingsInit=function(){debugMode&&
console.log("callback settingsInit: Initializing");for(var a=document.querySelector("#darkMode"),c=document.querySelector("#fullwidthMode"),b=document.querySelector("#removeSettingsBtn"),d=document.querySelector("#hideSidebar"),k=document.querySelector("#hideTheUpload"),e=document.querySelector("#hideBranding"),g=document.querySelectorAll('input[name="displayType"]'),v=document.querySelector("#removePreviews"),m=document.querySelector("#removePlaylists"),p=document.querySelector("#removeLongTracks"),
w=document.querySelector("#removeUserActivity"),t=document.querySelector("#removeReposts"),l=document.querySelector("#hiddenOutline"),r=document.querySelector("#profileImages"),h=document.querySelector("#relatedActionMenu"),u=document.querySelector("#tagActionMenu"),q=document.querySelector("#artistActionMenu"),f=document.querySelector("#trackActionMenu"),x=document.querySelector("#disableUnfollower"),z=document.querySelector("#disableDiscoverToggle"),n=document.querySelector("#sce-settings-reset"),
C=document.querySelectorAll(".sce-close-settings"),A=C.length,y=0;y<A;y++)C[y].addEventListener("click",function(){disassembleSettings()});document.addEventListener("mousedown",function(a){var b=null==a?event:a;1!=b.which&&0!=b.button&&1!=b.button||"sce-settings"!=a.target.id||disassembleSettings()});n.addEventListener("click",function(){"true"==n.getAttribute("warning")?resetLocalStorage(function(){location.reload()}):(n.setAttribute("warning",!0),n.innerText="Are you sure you want to reset?",setTimeout(function(){n.setAttribute("warning",
!1);n.innerText="Reset all SCEnhancer settings"},5E3))});getLocalStorage(function(n){"on"==n.darkMode&&(a.checked=!0);"on"==n.fullwidthMode&&(c.checked=!0);"on"==n.removeSettingsBtn&&(b.checked=!0);"on"==n.hideSidebar&&(d.checked=!0);"on"==n.hideTheUpload&&(k.checked=!0);"on"==n.hideBranding&&(e.checked=!0);"list"==n.displayType?g[1].checked=!0:"grid"==n.displayType?g[2].checked=!0:g[0].checked=!0;"on"==n.removePreviews&&(v.checked=!0);"on"==n.removePlaylists&&(m.checked=!0);"on"==n.removeLongTracks&&
(p.checked=!0);"on"==n.removeUserActivity&&(w.checked=!0);"on"==n.removeReposts&&(t.checked=!0);"on"==n.hiddenOutline&&(l.checked=!0);"on"==n.profileImages&&(r.checked=!0);"on"==n.disableUnfollower&&(x.checked=!0);"on"==n.disableDiscoverToggle&&(z.checked=!0);n.moreActionMenu&&("on"==n.moreActionMenu.relatedActionMenu&&(h.checked=!0),"on"==n.moreActionMenu.tagActionMenu&&(u.checked=!0),"on"==n.moreActionMenu.artistActionMenu&&(q.checked=!0),"on"==n.moreActionMenu.trackActionMenu&&(f.checked=!0))});
document.querySelector("#sce-settings-save").addEventListener("click",function(){for(var a=document.forms["sce-settings-form"].querySelectorAll("input"),b=a.length,c=[],f=0;f<b;f++){var n=a[f].name,d=a[f].type,h=a[f].checked,q=a[f].value,d="checkbox"==d?h?"on":"off":"radio"==d?h?q:"skip":q;"skip"!=d&&(c[n]=d)}saveSettings(c)})},filterInit=function(){debugMode&&console.log("callback filterInit: Initializing");var a=document.querySelector("#artist-blacklist"),c=document.querySelector("#track-blacklist"),
b=document.querySelector("#playlist-blacklist"),d=document.querySelector("#skipTags");getLocalStorage(function(a){null!=a.tagsArray&&(d.value=a.tagsArray);insignia(skipTags,{delimiter:",",deletion:!0});a=document.querySelector(".nsg-tags");runObserver(a,function(){for(var a=document.querySelectorAll(".nsg-tag"),b=a.length,c=[],d=0;d<b;d++)c.push(a[d].innerText);setLocalStorage(function(){chrome.runtime.lastError&&alert("Error while saving settings:\n\n"+chrome.runtime.lastError);debugMode&&console.log("Tag array saved: "+
c)},{tagsArray:c})},!0)});var k=function(a){a=a.split("/");var b=a[0];"sets"==a[1]?b=a[2]:a[1]&&(b=a[1]);b=b.replace(/-/g," ");return b=b.replace(/_/g," ")},e=function(a,b){getLocalStorage(function(c){var d=c.filter.tracks,g=d.length,e=[],l=function(a){for(var b=0;b<g;b++)1==a&&isPlaylistURL(d[b].slug)&&e.push(d[b]),0==a&&(isPlaylistURL(d[b].slug)||e.push(d[b]));d=e},m=function(a,b,c){for(var f=a.length;f--;)a[f]&&a[f].hasOwnProperty(b)&&a[f][b]===c&&a.splice(f,1);return a};c.filter&&("artists"==
b&&c.filter.artists?d=c.filter.artists:"tracks"==b&&c.filter.tracks?l(!1):c.filter.tracks&&l(!0));c=d.length;if(0==c)c=document.createElement("span"),c.innerHTML="No "+b+" has been filtered!",a.appendChild(c);else for(l={i:0};l.i<c;l={i:l.i,listItemDelete:l.listItemDelete},l.i++){var h=document.createElement("li"),u=document.createElement("span"),q=document.createElement("a"),f=document.createElement("div"),x=document.createElement("span");l.listItemDelete=document.createElement("span");var z=l.i+
1;u.className="sce-filter-item-order";u.innerText="#"+z;f.className="sce-filter-actions";q.className="sce-filter-item-name";q.href="https://soundcloud.com/"+d[l.i].slug;q.innerText=k(d[l.i].slug);q.target="_blank";x.innerText=relativeTime(d[l.i].time);x.className="sce-filter-option";l.listItemDelete.className="sce-filter-option-remove";h.appendChild(u);h.appendChild(q);f.appendChild(x);f.appendChild(l.listItemDelete);h.appendChild(f);a.appendChild(h);l.listItemDelete.addEventListener("click",function(a){return function(){getLocalStorage(function(c){c=
c.filter;"artists"==b?m(c.artists,"slug",d[a.i].slug):m(c.tracks,"slug",d[a.i].slug);setLocalStorage(function(){a.listItemDelete.closest("li").remove();for(var c=document.querySelectorAll(".filter-container"),f=c.length,d=0;d<f;d++)if(!c[a.i].hasChildNodes()){var h=document.createElement("span");h.innerHTML="No "+b+" has been filtered!";c[d].appendChild(h)}},{filter:c})},["filter"])}}(l))}})};e(a,"artists");e(c,"tracks");e(b,"playlists")},getLocalStorage=function(a,c){chrome.storage.sync.get((void 0===
c?null:c)||getGlobalSettings,a)},setLocalStorage=function(a,c){chrome.storage.sync.set((void 0===c?null:c)||setGlobalSettings,a)},resetLocalStorage=function(a){chrome.storage.sync.remove(getGlobalSettings,a)},readyStateCheck=function(){var a,c=new MutationObserver(function(b){clearTimeout(a);a=setTimeout(function(){debugMode&&console.log("readyState: Complete");c.disconnect();settingsSetup();injectedJavascript()},200)});c.observe(body,globalConfig)};document.addEventListener("readystatechange",readyStateCheck);
setInterval(function(){location.href!=oldLocation&&(debugMode&&console.log("-=- NEW PAGE LOADED -=-"),oldLocation=location.href,readyStateCheck())},100);
var setAttributes=function(){debugMode&&console.log("function setAttributes: Initializing");getLocalStorage(function(a){"on"==a.darkMode&&body.setAttribute("data-theme","dark");"on"==a.fullwidthMode&&body.setAttribute("fullwidth","");"on"!=a.removeSettingsBtn&&body.setAttribute("settings-button","");"on"==a.hideSidebar?body.setAttribute("data-sidebar","hidden"):body.setAttribute("data-sidebar","show");"https://soundcloud.com/stream"==location.href&&("list"==a.displayType?body.setAttribute("data-display",
"list"):"grid"==a.displayType?body.setAttribute("data-display","grid"):body.setAttribute("data-display","default"));"on"==a.hiddenOutline&&body.setAttribute("hidden-outline","");"on"==a.profileImages&&body.setAttribute("square","")})};setAttributes();
var settingsSetup=function(){debugMode&&console.log("function settingsSetup: Initializing");var a=document.querySelector("#stream-controller"),c=document.querySelector("#version-display"),b=document.querySelector("#enhancer-btn"),d=document.querySelector(".playControls"),k=document.querySelector(".playControls__inner"),e=document.querySelector(".announcements.g-z-index-fixed-top"),g=document.querySelector(".header__userNavUsernameButton"),v=document.querySelector(".header__logo.left");d.className=
"playControls g-z-index-header m-visible";e.className="announcements g-z-index-fixed-top m-offset";getLocalStorage(function(d){if("on"!=d.hideBranding&&(v.id="sce-logo",!c)){var e=document.createElement("span");e.id="version-display";e.innerText=manifestData.version;v.appendChild(e)}if("on"!=d.removeSettingsBtn&&!b){var e=document.createElement("div"),m=document.createElement("button");e.id="enhancer-container";m.className="sc-enhancer sc-button sc-button-medium sc-button-responsive";m.id="enhancer-btn";
m.tabindex="0";m.innerText="SCEnhancer";e.appendChild(m);k.appendChild(e);settingsMenu()}if("https://soundcloud.com/stream"==location.href||"https://soundcloud.com/charts/top"==location.href||"https://soundcloud.com/discover"==location.href)var t=setInterval(function(){var a=document.querySelector(".streamExploreTabs ul.g-tabs");if(3==a.querySelectorAll("li").length&&(clearInterval(t),!a.querySelector("#the-upload-tab"))){var b=document.createElement("li"),c=document.createElement("a");b.className=
"g-tabs-item";c.className="g-tabs-link";c.id="the-upload-tab";c.href="/discover/sets/new-for-you:"+userID;c.innerText="The Upload";b.appendChild(c);a.appendChild(b)}},100);var l=setInterval(function(){var a=document.querySelector("ul.profileTabs.g-tabs");if(a&&!document.querySelector("#profile-tab-like")){clearInterval(l);var b=a.querySelector(".g-tabs-link:first-child").getAttribute("href"),c=document.createElement("li"),d=document.createElement("a");c.className="g-tabs-item";c.id="profile-tab-like";
d.className="g-tabs-link";d.href=b+"/likes";d.innerText="Likes";c.appendChild(d);a.appendChild(c)}},100),r=function(){if(!document.querySelector(".profileMenu__list.profileMenu__enhancer.sc-list-nostyle")){g.removeEventListener("click",r);var a=document.querySelector(".profileMenu"),c=document.createElement("ul"),b=document.createElement("li"),d=document.createElement("a");c.className="profileMenu__list profileMenu__enhancer sc-enhancer sc-list-nostyle";b.className="profileMenu__item";d.className=
"profileMenu__link profileMenu__enhancerMenu";d.innerText="SCEnhancer";b.appendChild(d);c.appendChild(b);a.appendChild(c);settingsMenu();var h=setInterval(function(){document.querySelector(".profileMenu__list.profileMenu__enhancer.sc-list-nostyle")||(settingsMenu(),clearInterval(h),g.addEventListener("click",r))},100)}};g.removeEventListener("click",r);g.addEventListener("click",r);if("on"!=d.disableDiscoverToggle&&"https://soundcloud.com/discover"==location.href)var h=setInterval(function(){var a=
document.querySelector("div.modularHome.lazyLoadingList ul.lazyLoadingList__list");if(a){clearInterval(h);var c=function(){getLocalStorage(function(c){debugMode&&console.log("function discoverModuleHider: Running");for(var b=a.querySelectorAll(".selectionModule"),d=b.length,f={i:0};f.i<d;f={moduleSwitch:f.moduleSwitch,i:f.i},f.i++){var h=c.discoverModules||{},q=1==h[f.i]?"hidden":"shown",x=b[f.i].querySelector("h2.selectionModule__titleText"),e=x.querySelector("a.hide-discover-section");b[f.i].setAttribute("state",
q);e||(q=1==h[f.i]?0:1,h=1==h[f.i]?"Show this section":"Hide this section",e=document.createElement("a"),e.className="hide-discover-section",e.innerText=h,e.setAttribute("section-id",f.i),e.setAttribute("section-state",q),x.appendChild(e),f.moduleSwitch=document.querySelector('.hide-discover-section[section-id="'+f.i+'"]'),f.moduleSwitch.addEventListener("click",function(a){return function(){getLocalStorage(function(c){var b=a.moduleSwitch.getAttribute("section-id"),d=a.moduleSwitch.getAttribute("section-state"),
f=c.discoverModules||{};f[b]=d;setLocalStorage(function(){if(chrome.runtime.lastError)alert("Error while saving settings:\n\n"+chrome.runtime.lastError);else{var c=1==f[b]?"Show this section":"Hide this section",d=1==f[a.i]?"hidden":"shown",h=1==f[b]?0:1,q=a.moduleSwitch.closest(".selectionModule");a.moduleSwitch.innerText=c;a.moduleSwitch.setAttribute("section-state",h);q.setAttribute("state",d)}},{discoverModules:f})})}}(f)))}})};c();runObserver(a,c)}},100);if("https://soundcloud.com/stream"==location.href)var u=
setInterval(function(){var c=document.querySelector(".stream__header");if(c&&(clearInterval(u),!a)){var b=document.createElement("div"),h=document.createElement("div"),q=document.createElement("h3"),e=document.createElement("ul"),g=document.createElement("li"),k=document.createElement("li"),l=document.createElement("li");b.className="stream__controls";b.id="stream-controller";h.className="listDisplayToggle g-flex-row-centered";q.className="listDisplayToggleTitle sc-text-light sc-type-medium";q.innerText=
"View";e.className="listDisplayToggle sc-list-nostyle g-flex-row-centered";g.className="listDisplayToggle setting-display-tile default-icon";g.title="Default";g.setAttribute("data-id","default");k.className="listDisplayToggle setting-display-tile list-icon";k.title="Compact";k.setAttribute("data-id","list");l.className="listDisplayToggle setting-display-tile grid-icon";l.title="Grid";l.setAttribute("data-id","grid");h.appendChild(q);e.appendChild(g);e.appendChild(k);e.appendChild(l);h.appendChild(e);
b.appendChild(h);c.appendChild(b);var m=document.querySelector(".listDisplayToggle.setting-display-tile.default-icon"),p=document.querySelector(".listDisplayToggle.setting-display-tile.list-icon"),t=document.querySelector(".listDisplayToggle.setting-display-tile.grid-icon");"list"==d.displayType?p.classList.add("active"):"grid"==d.displayType?t.classList.add("active"):m.classList.add("active");for(var r=document.querySelectorAll(".listDisplayToggle.setting-display-tile"),B=r.length,c={i:0};c.i<B;c=
{i:c.i},c.i++)r[c.i].addEventListener("click",function(a){return function(){for(var c=r[a.i].getAttribute("data-id"),b=0;b<B;b++)r[b].classList.remove("active");"list"==c?(body.setAttribute("data-display","list"),p.classList.add("active")):"grid"==c?(body.setAttribute("data-display","grid"),t.classList.add("active")):(body.setAttribute("data-display","default"),m.classList.add("active"));setLocalStorage(function(){chrome.runtime.lastError&&alert("Error while saving settings:\n\n"+chrome.runtime.lastError);
debugMode&&console.log("Display mode saved: "+c)},{displayType:c})}}(c))}},100);if("https://soundcloud.com/you/following"==location.href&&"on"!=d.disableUnfollower)var q=setInterval(function(){var a=document.querySelector(".collectionSection__list .lazyLoadingList.badgeList ul.lazyLoadingList__list");if(a){clearInterval(q);var c=document.querySelector(".collectionSection__top");if(null==document.querySelector("#mass-unfollow")){var b=document.createElement("div"),d=document.createElement("div"),h=
document.createElement("h3"),e=document.createElement("button"),g=document.createElement("button"),u=document.createElement("button");b.className="stream__controls";b.id="mass-unfollow";d.className="g-flex-row-centered";h.className="sc-text-light sc-type-medium margin-spacing";h.innerText="Options:";e.className="sc-button margin-spacing";e.id="confirm-unfollow-button";e.innerText="Mass unfollow";g.className="sc-button margin-spacing";g.id="undo-unfollow-button";g.innerText="Reset selection";u.className=
"sc-button";u.id="all-unfollow-button";u.innerText="Select all";d.appendChild(h);d.appendChild(e);d.appendChild(g);d.appendChild(u);b.appendChild(d);insertAfter(b,c);c.style.margin="0px"}multiFollow();runObserver(a,multiFollow);var k=document.querySelector("#confirm-unfollow-button"),a=document.querySelector("#undo-unfollow-button"),c=document.querySelector("#all-unfollow-button");k.addEventListener("click",function(){for(var a=document.querySelectorAll(".badgeList__item"),c=a.length,b=0,d=0;d<c;d++)1==
a[d].querySelector("label.userBadgeListItem__checkbox input.sc-checkbox-input").checked&&(a[d].querySelector(".userBadgeListItem .userBadgeListItem__action button.sc-button-follow").click(),b++);k.innerText=1==b?"1 account got unfollowed!":b+" accounts got unfollowed!";setTimeout(function(){k.innerText="Mass unfollow"},3E3)});a.addEventListener("click",function(){massSelector(!1)});c.addEventListener("click",function(){massSelector(!0)})}},100)})},renderSettings=function(){debugMode&&console.log("function renderSettings: Initializing");
body.className="g-overflow-hidden";body.style.paddingRight="0px";app.className="g-filter-grayscale";var a=document.createElement("div"),c=document.createElement("button"),b=document.createElement("div"),d=document.createElement("div"),k=document.createElement("h1"),e=document.createElement("span"),g=document.createElement("ul"),v=document.createElement("li"),m=document.createElement("li"),p=document.createElement("li"),w=document.createElement("li"),t=document.createElement("ul"),l=document.createElement("li"),
r=document.createElement("label"),h=document.createElement("input"),u=document.createElement("li"),q=document.createElement("a"),f=document.createElement("a"),x=document.createElement("a"),z=document.createElement("a"),n=document.createElement("a"),C=document.createElement("a"),A=document.createElement("div"),y=document.createElement("div"),E=document.createElement("div"),F=document.createElement("div"),G=document.createElement("div"),J=document.createElement("hr"),H=document.createElement("span"),
B=document.createElement("a");a.id="sce-settings";a.className="modal g-z-index-modal-background g-opacity-transition g-z-index-overlay modalWhiteout showBackground invisible";a.style.paddingRight="0px";a.style.outline="none";a.style.overflow="hidden";a.tabindex="-1";c.className="modal__closeButton sce-close-settings";c.title="Close";c.type="button";c.innerText="Close";b.className="modal__modal sc-border-box g-z-index-modal-content";d.className="modal__content";k.id="sce-settings-title";k.className=
"g-modal-title-h1 sc-truncate";k.innerText="SoundCloud Enhancer "+manifestData.version;e.className="credits";e.innerHTML="Made with <span class='heart'>&hearts;</span> in Denmark by <a href='https://twitter.com/DapperBenji' target='_blank'>@DapperBenji</a>.";g.id="tab-container";g.className="g-tabs g-tabs-small";v.className="g-tabs-item";m.className="g-tabs-item";p.className="g-tabs-item";w.className="g-tabs-item";t.className="g-side-items";l.className="g-tabs-item";l.id="sce-import";h.className=
"hidden";h.type="file";h.accept=".json";u.className="g-tabs-item";u.id="sce-export";q.setAttribute("action","settings");q.className="tab g-tabs-link active";q.innerText="Settings";f.setAttribute("action","filter");f.className="tab g-tabs-link";f.innerText="Filter (beta)";x.setAttribute("action","changelog");x.className="tab g-tabs-link";x.innerText="Changelog";z.setAttribute("action","about");z.className="tab g-tabs-link";z.innerText="About";n.className="g-tabs-link";n.innerText="Import";C.className=
"g-tabs-link";C.innerText="Export";A.id="sce-settings-content";y.className="tabPage";y.id="settings";y.style.display="block";E.className="tabPage";E.id="filter";F.className="tabPage";F.id="changelog";G.className="tabPage";G.id="about";H.className="donation";B.href="https://www.paypal.me/BenjaminBachJensen";B.innerText="Support the development - Buy me a cup of coffee ;)";B.target="_blank";A.appendChild(y);A.appendChild(E);A.appendChild(F);A.appendChild(G);v.appendChild(q);m.appendChild(f);p.appendChild(x);
w.appendChild(z);r.appendChild(n);r.appendChild(h);l.appendChild(r);u.appendChild(C);t.appendChild(l);t.appendChild(u);g.appendChild(v);g.appendChild(m);g.appendChild(p);g.appendChild(w);g.appendChild(t);H.appendChild(B);d.appendChild(k);d.appendChild(e);d.appendChild(g);d.appendChild(A);d.appendChild(J);d.appendChild(H);b.appendChild(d);a.appendChild(c);a.appendChild(b);body.appendChild(a);setTimeout(function(){a.classList.remove("invisible")},10);setTimeout(function(){a.style.overflow=null},400);
fetchFile(y,"/assets/html/settings.html",settingsInit);fetchFile(E,"/assets/html/filter.html",filterInit);fetchFile(F,"/assets/html/changelog.html");fetchFile(G,"/assets/html/about.html");for(var D=document.querySelectorAll(".tab"),I=D.length,c={i:0};c.i<I;c={i:c.i},c.i++)D[c.i].addEventListener("click",function(a){return function(){for(var c=0;c<I;c++)D[c].className="tab g-tabs-link";D[a.i].className="tab g-tabs-link active";for(var c=document.querySelectorAll(".tabPage"),b=c.length,d=0;d<b;d++)c[d].style.display=
"none";c=D[a.i].getAttribute("action");document.getElementById(c).style.display="block"}}(c));getLocalStorage(exportimportInit)},saveSettings=function(a){var c={};"on"!=a.darkMode&&(a.darkMode="off");"on"!=a.fullwidthMode&&(a.fullwidthMode="off");"on"!=a.removeSettingsBtn&&(a.removeSettingsBtn="off");"on"!=a.hideSidebar&&(a.hideSidebar="off");"on"!=a.hideBranding&&(a.hideBranding="off");"default"==a.displayType&&(a.displayType="");"on"!=a.removePreviews&&(a.removePreviews="off");"on"!=a.removePlaylists&&
(a.removePlaylists="off");"on"!=a.removeLongTracks&&(a.removeLongTracks="off");"on"!=a.removeUserActivity&&(a.removeUserActivity="off");"on"!=a.removeReposts&&(a.removeReposts="off");"on"!=a.hiddenOutline&&(a.hiddenOutline="off");"on"!=a.profileImages&&(a.profileImages="off");"on"!=a.disableUnfollower&&(a.disableUnfollower="off");"on"!=a.disableDiscoverToggle&&(a.disableDiscoverToggle="off");c.relatedActionMenu="on"!=a.relatedActionMenu?"off":"on";c.tagActionMenu="on"!=a.tagActionMenu?"off":"on";
c.artistActionMenu="on"!=a.artistActionMenu?"off":"on";c.trackActionMenu="on"!=a.trackActionMenu?"off":"on";setGlobalSettings.darkMode=a.darkMode;setGlobalSettings.fullwidthMode=a.fullwidthMode;setGlobalSettings.removeSettingsBtn=a.removeSettingsBtn;setGlobalSettings.hideSidebar=a.hideSidebar;setGlobalSettings.hideBranding=a.hideBranding;setGlobalSettings.displayType=a.displayType;setGlobalSettings.removePreviews=a.removePreviews;setGlobalSettings.removePlaylists=a.removePlaylists;setGlobalSettings.removeLongTracks=
a.removeLongTracks;setGlobalSettings.removeUserActivity=a.removeUserActivity;setGlobalSettings.removeReposts=a.removeReposts;setGlobalSettings.hiddenOutline=a.hiddenOutline;setGlobalSettings.profileImages=a.profileImages;setGlobalSettings.disableUnfollower=a.disableUnfollower;setGlobalSettings.disableDiscoverToggle=a.disableDiscoverToggle;setGlobalSettings.moreActionMenu=c;setLocalStorage(function(){chrome.runtime.lastError?alert("Error while saving settings:\n\n"+chrome.runtime.lastError):location.reload()})},
settingsMenu=function(){debugMode&&console.log("function settingsMenu: Initializing");for(var a=document.querySelectorAll(".sc-enhancer"),c=a.length,b=0;b<c;b++)a[b].removeEventListener("click",renderSettings),a[b].addEventListener("click",renderSettings)},injectedJavascript=function(){debugMode&&console.log("function injectedJavascript: Initializing");document.querySelector("#content");var a=document.querySelector(".playbackSoundBadge");document.querySelector(".stream__header");var c=document.querySelector(".header__userNavUsernameButton").getAttribute("href"),
b=document.querySelector(".skipControl__next"),d=document.querySelector(".skipControl__previous"),k=function(){getLocalStorage(function(a){for(var c=["tag","artist","track"],b=c.length,d={filter:0};d.filter<b;d={filter:d.filter},d.filter++){var h=null,e=null,g=function(a,c,b){stripLinkDomain(c.href)==b.slug&&a()};switch(c[d.filter]){case "tag":h=document.querySelectorAll(".soundTitle__tagContent");a.tagsArray&&(e=a.tagsArray);g=function(a,c,b){c.innerText.toUpperCase()==b.toUpperCase()&&a(b)};break;
case "artist":h=document.querySelectorAll(".soundTitle__username");a.filter&&a.filter.artists&&(e=a.filter.artists);break;case "track":h=document.querySelectorAll(".soundTitle__title"),a.filter&&a.filter.tracks&&(e=a.filter.tracks)}if(h&&e)for(var k=h.length,l=e.length,m=0;m<k;m++)for(var p={},r=0;r<l;p={parentElement:p.parentElement},r++){var t=moreActionParentClassName(h[m]);p.parentElement=h[m].closest(t);g(function(a,b){return function(d){d=void 0===d?null:d;a.parentElement.setAttribute("data-skip",
"true");d?a.parentElement.setAttribute("banned-"+c[b.filter]+"",d):a.parentElement.setAttribute("banned-"+c[b.filter]+"","");a.parentElement.className+=" hidden"}}(p,d),h[m],e[r])}}},["filter","tagsArray"])},e=function(){debugMode&&console.log("function markPlaylists: Running");for(var a=document.querySelectorAll(".soundList__item .activity div.sound.streamContext"),c=a.length,b=0;b<c;b++)if(1==a[b].className.includes("playlist")){var d;d=a[b].querySelectorAll(".compactTrackList__listContainer .compactTrackList__item");
if(5>d.length)d=d.length;else{var e=a[b].querySelector(".compactTrackList__moreLink");d=e?e.innerText.replace(/\D/g,""):d.length}e=a[b].closest(".soundList__item");e.setAttribute("data-playlist","true");e.setAttribute("data-count",d)}},g=function(){debugMode&&console.log("function hidePreviews: Running");for(var a=document.querySelectorAll(".sc-snippet-badge.sc-snippet-badge-medium.sc-snippet-badge-grey"),c=a.length,b=0;b<c;b++)if(a[b].innerHTML){var d=a[b].closest(".soundList__item");d.setAttribute("data-skip",
"true");d.setAttribute("data-type","preview");d.className="soundList__item hidden"}},v=function(){debugMode&&console.log("function hidePlaylists: Running");for(var a=document.querySelectorAll(".soundList__item"),c=a.length,b=0;b<c;b++)"true"==a[b].getAttribute("data-playlist")&&(a[b].setAttribute("data-skip","true"),a[b].className="soundList__item hidden")},m=function(){debugMode&&console.log("function hideReposts: Running");for(var a=document.querySelectorAll(".soundContext__repost"),c=a.length,
b=0;b<c;b++){var d=a[b].closest(".soundList__item");d.setAttribute("data-skip","true");d.setAttribute("data-type","repost");d.className="soundList__item hidden"}},p=function(){debugMode&&console.log("function checkCanvas: Running");for(var a=document.querySelectorAll(".sound__waveform .waveform .waveform__layer.waveform__scene"),b=0;b<a.length;b++)for(var c=a[b].querySelectorAll("canvas.g-box-full.sceneLayer"),d=0;d<c.length;d++){var e=c[c.length-1],e=e.getContext("2d").getImageData(e.width-27,27,
1,1).data;0==e[0]&&0==e[1]&&0==e[2]&&255==e[3]&&(e=a[b].closest(".soundList__item"),e.setAttribute("data-skip","true"),e.setAttribute("data-type","long"),e.className="soundList__item hidden")}},w=function(){debugMode&&console.log("function checkUserActivity: Running");for(var a=document.querySelectorAll(".soundContext__usernameLink"),b=a.length,d=0;d<b;d++){var e=a[d].getAttribute("href");c==e&&(e=a[d].closest(".soundList__item"),e.setAttribute("data-skip","true"),e.setAttribute("data-type","yours"),
e.className="soundList__item hidden")}},t=function(a){if(!document.querySelector(".moreActions #sce-moreActions-group")){var b=moreActionParentClassName(a.target);a=a.target.closest(b);moreActionMenuContent(a)}},l=function(){for(var a=document.querySelectorAll("button.sc-button-more.sc-button-small"),b=a.length,c=0;c<b;c++)a[c].removeEventListener("click",t),a[c].addEventListener("click",t)},r=setInterval(function(){if(document.querySelector(".l-fluid-fixed > .l-main .lazyLoadingList ul, .l-fixed-fluid > .l-main .lazyLoadingList > ul, .l-hero-fluid-fixed .l-main .lazyLoadingList, .l-collection .l-main .lazyLoadingList")){var c=
document.querySelectorAll(".lazyLoadingList > ul, .lazyLoadingList > div > ul"),t=c.length;debugMode&&console.log(c);clearInterval(r);getLocalStorage(function(a){l();e();k();"on"==a.removePreviews&&g();"on"==a.removePlaylists&&v();"on"==a.removeReposts&&m();"on"==a.removeLongTracks&&p();"on"==a.removeUserActivity&&w();for(var b=0;b<t;b++)runObserver(c[b],l),runObserver(c[b],e),runObserver(c[b],k),"on"==a.removePreviews&&runObserver(c[b],g),"on"==a.removePlaylists&&runObserver(c[b],v),"on"==a.removeReposts&&
runObserver(c[b],m),"on"==a.removeLongTracks&&runObserver(c[b],p),"on"==a.removeUserActivity&&runObserver(c[b],w)});runObserver(a,function(){getLocalStorage(function(a){a=document.querySelectorAll(".soundList__item");for(var c=a.length,e=0;e<c;e++){var g=a[e].getAttribute("data-skip"),h=a[e].getAttribute("data-playlist");a[e].querySelector(".soundTitle__title span");if(1==a[e].querySelector(".activity div.sound.streamContext").className.includes("playing"))if(debugMode&&console.log("Skip song?: "+
g),"true"==g)if(d.addEventListener("click",function(){skipPrevious=!0}),1==h)if(g=a[e].getAttribute("data-count"),1==skipPrevious)for(h=0;h<g;h++)d.click();else for(h=0;h<g;h++)b.click();else 1==skipPrevious?d.click():b.click();else skipPrevious=!1}})})}},100)};
